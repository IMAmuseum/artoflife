<html>
<head>

<style>

.page .info {
	font-size: 80%;
}

.page .page-thumbnail {
	height: 200px;
	float: right;
}

.page {
	width: 300px;
	padding: 5px;
	margin: 5px;
	float: left;
}

.alg-result {
	padding: 10px;
	color: #fff;
}

.alg-result div {
	clear: left;
	float: left;
}

.true-pos {
	background-color: #0a0;
}

.false-pos {
	background-color: #00f;
}

.false-neg {
	background-color: #f00;
}

.true-neg {
	background-color: #000;
}

.hidden {
	display: none;
}

#filters {
	background: #eee;
	position: fixed;
	top: 0px;
	right: 0px;
	padding: 10px;
}

.swatch {
	float: right;
	width: 10px;
	height: 10px;
	margin: 4px;
}

</style>

<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js'></script>
<script type='text/javascript'>
	$(document).ready(function() {

		$('#filters [name="show"]').change(function() {
			$('.' + this.value).parents('.page').toggleClass('hidden');
		});


	});
</script>

</head>
<body>

<h2>Page data for {{ scan_id }}</h2>

<div id='filters'>
  <select id='alg'>
  	<option value='abbyy'>ABBYY</option> 
  </select>
  <br/>
  <input id='toggle-true-pos' type='checkbox' checked='checked' name='show' value='true-pos'/>Show true positives<div class='true-pos swatch'></div><br/>
  <input id='toggle-true-neg' type='checkbox' checked='checked' name='show' value='true-neg'/>Show true negatives<div class='true-neg swatch'></div><br/>
  <input id='toggle-true-neg' type='checkbox' checked='checked' name='show' value='false-pos'/>Show false positives<div class='false-pos swatch'></div><br/>
  <input id='toggle-true-neg' type='checkbox' checked='checked' name='show' value='false-neg'/>Show false negatives<div class='false-neg swatch'></div><br/>    

</div>

<p>Actual # of illustrations: {{ n_illustrations }}</p>

<h3>Algorithm results:</h3>
<ul>
	<li>ABBYY: {{ abbyy.n_pos }} positives, P = {{ abbyy.precision }}, R = {{ abbyy.recall }}</li>
    <li>Contrast: {{ contrast.n_pos }} positives, P = {{ contrast.precision }}, R = {{ contrast.recall }}</li>
</ul>

<div class='pages'>
{% for page in pages %}
	<div class='page' style='margin-bottom: 0.5em; background-color: #eee;'>

		<img class='page-thumbnail' 
		     src="/mongo/ia-thumb/{{scan_id}}/{{page.ia_page_num}}"/>

		<div class='info'>
			<div class='scandata_index'>Scandata index: {{ page.scandata_index }}</div>		
			<div class='ia_page_number'>IA page number: {{ page.ia_page_num }}</div>
			<div class='golden'>Has illustration: {% if page.has_illustration.gold_standard %}YES{% else %}NO{% endif %}</div>
	        <div class='picture_blocks'># of blocks: {{ page.abbyy.picture_blocks|length }}</div>
	        <div class='total_coverage'>Sum of block coverage: {{ page.abbyy.coverage_sum|floatformat:3 }}%</div>
	        <div class='compression'>Compression ratio: {{ page.compression|floatformat:3 }}</div>
	        <div class='alg-result'>
	        	<div class='{{ page.alg_result.abbyy }}'>ABBYY</div>
	        </div>	        
       </div>

	</div>
{% endfor %}
</div>

</body>
</html>